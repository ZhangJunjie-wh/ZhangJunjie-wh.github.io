<!DOCTYPE html>
<!-- saved from url=(0055)https://baddogzz.github.io/2020/02/07/Unload-Resources/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="还没想好...">
    <meta name="keywords" content="还没想好...">
    <meta name="theme-color" content="#000000">
    
    <!-- Open Graph -->
    <meta property="og:title" content="关于AssetBundle的卸载 - 恶毒的狗 | Bad Fat Dog">
    
    <meta property="og:type" content="article">
    <meta property="og:description" content="关于AssetBundle的卸载

">
    
    <meta property="article:published_time" content="2020-02-07T00:00:00Z">
    
    
    <meta property="article:author" content="恶毒的狗">
    
    
    <meta property="article:tag" content="Unity">
    
    <meta property="article:tag" content="资源管理">
    
    
    <meta property="og:image" content="https://baddogzz.github.io//img/dog-01.png">
    <meta property="og:url" content="https://baddogzz.github.io//2020/02/07/Unload-Resources/">
    <meta property="og:site_name" content="恶毒的狗 | Bad Fat Dog">
    
    <title>关于AssetBundle的卸载 - 恶毒的狗 | Bad Fat Dog</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="https://baddogzz.github.io/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="https://baddogzz.github.io/img/favicon.ico">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://baddogzz.github.io//2020/02/07/Unload-Resources/">

    <!-- Bootstrap Core CSS -->
    <style class="anchorjs"></style><link rel="stylesheet" href="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/hux-blog.min.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script type="text/javascript" async="" src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/js"></script><script src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/jquery.nav.js"></script><script src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/hm.js"></script><script async="" src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/analytics.js"></script><script src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/fastclick.min.js"></script><script src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/anchor.min.js"></script><script></script>
<script type="text/javascript" async="" src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/embed.js"></script><script async="" id="dsq_recs_scr" src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/recommendations.js"></script><script src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/alfie_v4.63f1ab6d6b9d5807dc0c94ef3fe0b851.js" async="" charset="UTF-8"></script></head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->

<nav class="navbar navbar-default navbar-custom navbar-fixed-top">

    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://baddogzz.github.io/">恶毒的狗</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div id="huxblog_navbar" class=" ">
            <div class="navbar-collapse" style="height: 0px;">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="https://baddogzz.github.io/">Home</a>
                    </li>
                    
                    
                    
                    
                    <li>
                        <a href="https://baddogzz.github.io/about/">About</a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://baddogzz.github.io/archive/">Archive</a>
                    </li>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    var __HuxNav__ = {
        close: function(){
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        },
        open: function(){
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }

    // Bind Event
    $toggle.addEventListener('click', function(e){
        if ($navbar.className.indexOf('in') > 0) {
            __HuxNav__.close()
        }else{
            __HuxNav__.open()
        }
    })

    /**
     * Since Fastclick is used to delegate 'touchstart' globally
     * to hack 300ms delay in iOS by performing a fake 'click',
     * Using 'e.stopPropagation' to stop 'touchstart' event from 
     * $toggle/$collapse will break global delegation.
     * 
     * Instead, we use a 'e.target' filter to prevent handler
     * added to document close HuxNav.  
     *
     * Also, we use 'click' instead of 'touchstart' as compromise
     */
    document.addEventListener('click', function(e){
        if(e.target == $toggle) return;
        if(e.target.className == 'icon-bar') return;
        __HuxNav__.close();
    })
</script>


    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/home-bg.png" width="0" height="0"> -->

<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/home-bg.png');
        background: ;
    }

    
    header.intro-header .header-mask{
        width: 100%;
        height: 100%;
        position: absolute;
        background: rgba(0,0,0, 0.2);
    }
    
</style>

<header class="intro-header">

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="https://baddogzz.github.io/archive/?tag=Unity" title="Unity">Unity</a>
                        
                        <a class="tag" href="https://baddogzz.github.io/archive/?tag=%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86" title="资源管理">资源管理</a>
                        
                    </div>
                    <h1 id="assetbundle">关于AssetBundle的卸载</h1>
                    
                    <h2 class="subheading" id=""></h2>
                    <span class="meta">Posted by 恶毒的狗 on February 7, 2020</span>
                </div>
            </div>
        </div>
    </div>
</header>






<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <!-- Multi-Lingual -->
                

				<h2 id="关于assetbundle的卸载">关于AssetBundle的卸载<a class="anchorjs-link " href="https://baddogzz.github.io/2020/02/07/Unload-Resources/#%E5%85%B3%E4%BA%8Eassetbundle%E7%9A%84%E5%8D%B8%E8%BD%BD" aria-label="Anchor link for: 关于assetbundle的卸载" data-anchorjs-icon="" style="font-family: anchorjs-icons; font-style: normal; font-variant: normal; font-weight: normal; padding-left: 0.375em;"></a></h2>

<p>又坐了一天月子，继续写文章找状态。</p>

<p>本文是关于 <strong>卸载AssetBundle</strong> 的一些知识点。</p>

<p>下图是一个最简单的从 <strong>AssetBundle</strong> 加载 <strong>Asset</strong> 并 <strong>实例化</strong> 的流程：</p>

<p><img src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/screenshot1.png" alt="img"></p>

<p>这里的 <strong>Bundle</strong> 在加载完 <strong>资源A</strong> 后就没用了，我们可以通过 <strong>AssetBundle.Unload(false)</strong> 把它卸掉，只保留住 <strong>资源A</strong>。</p>

<p>如果 <strong>资源A</strong> 也没用了，我们可以通过 <strong>Destroy</strong> 接口或者 <strong>Resources.UnloadAsset</strong> 接口销毁它。</p>

<p>题外话，我们需要注意一下 <strong>Resources.UnloadAsset</strong> 的应用场合：</p>

<blockquote>
  <p>This function can only be called on Assets that are stored on disk.</p>
</blockquote>

<blockquote>
  <p>The referenced asset (assetToUnload) will be unloaded from memory. The object will become invalid and can’t be loaded back from disk. Any subsequently loaded Scenes or assets that reference the asset on disk will cause a new instance of the object to be loaded from disk. This new instance will not be connected to the previously unloaded object.</p>
</blockquote>

<p><strong>UWA</strong> 也有相关的回答：</p>

<blockquote>
  <p>Resources.UnloadAsset仅能释放非GameObject和Component的资源，比如Texture、Mesh等真正的资源。对于由Prefab加载出来的Object或Component，则不能通过该函数来进行释放。</p>
</blockquote>

<p>好了，回到上图。</p>

<p>上图描述的场景过于简单，实际项目中，<strong>资源A</strong> 可能依赖 <strong>其他资源</strong>，并且 <strong>其他资源</strong> 又被打进 <strong>不同的Bundle</strong> 中，如下图：</p>

<p><img src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/screenshot2.png" alt="img"></p>

<p>这个时候，卸载 <strong>AssetBundle</strong> 就需要一定的 <strong>策略</strong> 了。</p>

<p>在介绍 <strong>卸载策略</strong> 之前，我们必须先了解清楚 <strong>AssetBundle.Unload</strong> 这个函数。</p>

<h2 id="关于assetbundleunload">关于AssetBundle.Unload<a class="anchorjs-link " href="https://baddogzz.github.io/2020/02/07/Unload-Resources/#%E5%85%B3%E4%BA%8Eassetbundleunload" aria-label="Anchor link for: 关于assetbundleunload" data-anchorjs-icon="" style="font-family: anchorjs-icons; font-style: normal; font-variant: normal; font-weight: normal; padding-left: 0.375em;"></a></h2>

<p>Unity官方文档对于 <strong>AssetBundle.Unload</strong> 的描述如下：</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-responsive"><table class="rouge-table table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">void</span> <span class="nf">Unload</span><span class="p">(</span><span class="kt">bool</span> <span class="n">unloadAllLoadedObjects</span><span class="p">);</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<blockquote>
  <p>Unloads assets in the bundle.</p>
</blockquote>

<blockquote>
  <p>When unloadAllLoadedObjects is false, compressed file data for assets inside the bundle will be unloaded, but any actual objects already loaded from this bundle will be kept intact. Of course you won’t be able to load any more objects from this bundle.</p>
</blockquote>

<blockquote>
  <p>When unloadAllLoadedObjects is true, all objects that were loaded from this bundle will be destroyed as well. If there are GameObjects in your Scene referencing those assets, the references to them will become missing.</p>
</blockquote>

<ul>
  <li>
    <p><strong>AssetBundle.Unload(false)</strong> 会把 <strong>Bundle</strong> 卸载，但是已经从 <strong>Bundle</strong> 里加载出来的 <strong>资源</strong> 是不会被卸载的。</p>
  </li>
  <li>
    <p><strong>AssetBundle.Unload(true)</strong> 不但会卸载 <strong>Bundle</strong>，也会卸载已经从 <strong>Bundle</strong> 里加载出来的 <strong>所有资源</strong>，哪怕这些 <strong>资源</strong> 还被引用着。</p>
  </li>
</ul>

<p>对于用户来说，如果选择 <strong>AssetBundle.Unload(true)</strong>，用户必须确保 <strong>Bundle</strong> 中已经加载的 <strong>资源</strong> 是没有被引用的，否则就会发生 <strong>资源丢失</strong>。</p>

<p>如果选择 <strong>AssetBundle.Unload(false)</strong>，用户就要承担起卸载 <strong>已加载资源</strong> 的责任，如果处理不当，就可能造成 <strong>资源重复</strong>，如下图：</p>

<p><img src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/screenshot3.png" alt="img"></p>

<p>最后，Unity提供了一个 <strong>Resources.UnloadUnusedAssets</strong> 接口帮助我们销毁没有任何引用的 <strong>野资源</strong>，不过这个函数会扫描全部对象，开销较大，一般只在 <strong>切场景</strong> 时调用。</p>

<h2 id="卸载assetbundle的策略">卸载AssetBundle的策略<a class="anchorjs-link " href="https://baddogzz.github.io/2020/02/07/Unload-Resources/#%E5%8D%B8%E8%BD%BDassetbundle%E7%9A%84%E7%AD%96%E7%95%A5" aria-label="Anchor link for: 卸载assetbundle的策略" data-anchorjs-icon="" style="font-family: anchorjs-icons; font-style: normal; font-variant: normal; font-weight: normal; padding-left: 0.375em;"></a></h2>

<p>了解 <strong>AssetBundle.Unload</strong> 的行为后，再来看一下我们采用过的策略。</p>

<h4 id="暗黑血统的策略">暗黑血统的策略<a class="anchorjs-link " href="https://baddogzz.github.io/2020/02/07/Unload-Resources/#%E6%9A%97%E9%BB%91%E8%A1%80%E7%BB%9F%E7%9A%84%E7%AD%96%E7%95%A5" aria-label="Anchor link for: 暗黑血统的策略" data-anchorjs-icon="" style="font-family: anchorjs-icons; font-style: normal; font-variant: normal; font-weight: normal; padding-left: 0.375em;"></a></h4>

<p>最早做 <strong>暗黑血统</strong> 的时候，我们卸载 <strong>AssetBundle</strong> 的策略如下：</p>

<ul>
  <li>
    <p>用 <strong>AssetBundle.Unload(false)</strong> 来卸载 <strong>Bundle</strong>。</p>
  </li>
  <li>
    <p>加载完资源后立即卸载 <strong>叶子节点的Bunlde</strong>，这里 <strong>叶子节点</strong> 表示 <strong>没有被其他Bundle所依赖的Bundle</strong>。</p>
  </li>
  <li>
    <p>对于 <strong>非叶子节点的Bundle</strong>，卸载逻辑完全依靠 <strong>引用计数</strong>。</p>
  </li>
</ul>

<p>以下图为例：</p>

<p><img src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/screenshot4.png" alt="img"></p>

<p>红框标注的 <strong>Bundle</strong> 可以在加载完 <strong>资源</strong> 后立刻卸载。</p>

<p>我们看一下包含 <strong>资源A和B的Bundle</strong>，如果我们只加载了 <strong>A</strong>，然后就把 <strong>Bundle</strong> 卸载了，然后我们再加载 <strong>B</strong>，这个时候 <strong>Bundle</strong> 又要被重新加载，如果我再从这个 <strong>Bundle</strong> 加载 <strong>A</strong>，这个时候不是就有 <strong>2个A</strong> 了？</p>

<p>事实上，因为 <strong>第一个A</strong> 依然还被我们的 <strong>AssetManager</strong> 管理着，上层逻辑不会直接从 <strong>Bundle</strong> 中去加载 <strong>A</strong>，而是从 <strong>AssetManager的缓存</strong> 中去拿，所以上述情况并不会出现。</p>

<p>我们再看一下包含 <strong>资源C的Bundle</strong>，如果我们加载完 <strong>C</strong> 后就把 <strong>Bundle</strong> 卸载了，然后我们再去加载 <strong>G</strong>，由于 <strong>G依赖C</strong>，<strong>C所在的Bundle</strong> 会再次被加载，同时加载出一个 <strong>新的C</strong>，这就是真正的 <strong>资源重复</strong> 了。</p>

<p>此外，因为我们的 <strong>AssetManager</strong> 只会管理 <strong>直接加载的资源</strong>，假设我们先加载了 <strong>G</strong>，<strong>C</strong> 做为 <strong>G</strong> 的依赖被 <strong>间接加载</strong>，此时我们再去直接加载 <strong>C</strong> 就无法命中 <strong>AssetManager</strong> 的缓存了。对于这种情况，<strong>AssetManager</strong> 必须做一些额外记录，稍微有点蛋疼。</p>

<p>最后，考虑一下 <strong>引用计数</strong>，假设我们已经销毁了 <strong>G</strong>，那么 <strong>G</strong> 依赖的所有Bundle引用计数会减 <strong>1</strong>，假设 <strong>包含D的Bundle</strong> 以及 <strong>包含H的Bundle</strong> 引用计数都为 <strong>０</strong> 了，选择 <strong>AssetBundle.Unload(false)</strong> 的结果是被 <strong>间接加载</strong> 的 <strong>D和H</strong> 在 <strong>Bundle卸载</strong> 后依然存活着，我们的 <strong>AssetManager</strong> 并没有管理到它们，它们变成了 <strong>野资源</strong>。</p>

<p>这一类 <strong>野资源</strong> 最终得依靠 <strong>Resources.UnloadUnusedAssets</strong> 来卸载，一般我们在 <strong>场景切换</strong> 时才做这个操作。</p>

<h4 id="当前项目的策略">当前项目的策略<a class="anchorjs-link " href="https://baddogzz.github.io/2020/02/07/Unload-Resources/#%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E7%9A%84%E7%AD%96%E7%95%A5" aria-label="Anchor link for: 当前项目的策略" data-anchorjs-icon="" style="font-family: anchorjs-icons; font-style: normal; font-variant: normal; font-weight: normal; padding-left: 0.375em;"></a></h4>

<p>暗黑血统的策略在线上工作良好，不过因为 <strong>AssetManager</strong> 只会管理 <strong>直接加载</strong> 的资源，<strong>AssetBundle.Unload(false)</strong> 必须配合 <strong>Resources.UnloadUnusedAssets</strong> 才能完成一次彻底的资源清除。</p>

<p>当前项目，<strong>AssetManager</strong> 依然只管理 <strong>直接加载</strong> 的资源，不过我选择了 <strong>AssetBundle.Unload(true)</strong> 的策略，并且不再区分 <strong>Bundle是否是叶子节点</strong>，一切卸载的依据都是 <strong>引用计数</strong>。</p>

<p>正所谓 <strong>Bundle在，资源在，Bundle亡，资源亡</strong>，：）</p>

<p>以下图为例，最左边一列会标记出每个 <strong>Bundle</strong> 的引用计数：</p>

<p><img src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/screenshot5.png" alt="img"></p>

<p>当我们销毁 <strong>资源A</strong>，引用计数变化如下：</p>

<p><img src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/screenshot6.png" alt="img"></p>

<p>当我们再销毁 <strong>资源B</strong>，部分 <strong>Bundle</strong> 的引用计数变为0，调用 <strong>AssetBundle.Unload(true)</strong> 就能把资源及时清理干净了，如下图：</p>

<p><img src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/screenshot7.png" alt="img"></p>

<p>只要引用计数没问题，理论上 <strong>Resources.UnloadUnusedAssets</strong> 也就不用了。</p>

<h2 id="总结">总结<a class="anchorjs-link " href="https://baddogzz.github.io/2020/02/07/Unload-Resources/#%E6%80%BB%E7%BB%93" aria-label="Anchor link for: 总结" data-anchorjs-icon="" style="font-family: anchorjs-icons; font-style: normal; font-variant: normal; font-weight: normal; padding-left: 0.375em;"></a></h2>

<p>当前项目的方案在 <strong>资源回收的及时性</strong> 上要优于 <strong>暗黑血统</strong> 的方案，但是 <strong>暗黑血统</strong> 因为 <strong>提前卸载Bundle</strong> 的策略，<strong>Bundle数量</strong> 会更少一点。</p>

<p>其实早期 <strong>暗黑血统</strong> 在 <strong>提前卸载Bundle</strong> 的方案上做得更加激进：只有 <strong>被共享的Bundle</strong> 才不会被提前卸载，而非我上文所说的 <strong>叶子节点</strong>，当然，要堵不少bug。</p>

<p>考虑到目前 <strong>LZ4</strong> 的压缩策略，以及 <strong>AssetBundle.LoadFromFile</strong> 的加载方式，多一点 <strong>Bundle</strong> 的内存占用不会很高，但是多一点 <strong>资源</strong> 内存占用就比较高了。</p>

<p>题外话，下图是 <strong>UWA</strong> 关于 <strong>LZ4</strong> 和 <strong>LZMA</strong> 的总结，留图备忘：</p>

<p><img src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/screenshot8.png" alt="img"></p>

<p>本文就到这里，今年有机会也可以试试Unity推荐的 <a href="https://docs.unity3d.com/Packages/com.unity.addressables@1.6/manual/index.html">Addressable Assets</a>。</p>

<p>好了，拜拜。</p>



                <hr style="visibility: hidden;">
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="https://baddogzz.github.io/2020/02/05/Wet-Waves/" data-toggle="tooltip" data-placement="top" title="潮湿效果之水纹">
                        Previous<br>
                        <span>潮湿效果之水纹</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="https://baddogzz.github.io/2020/02/09/Object-Name-Memory/" data-toggle="tooltip" data-placement="top" title="关于Unity的Object.name的内存分配">
                        Next<br>
                        <span>关于Unity的Object.name的内存分配</span>
                        </a>
                    </li>
                    
                </ul>
                <hr style="visibility: hidden;">

                
                <!-- disqus 评论框 start -->
                <div class="comment">
                    <div id="disqus_recommendations" style="margin-bottom: 12px;"><iframe id="dsq-app7887" name="dsq-app7887" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/saved_resource.html" style="width: 100% !important; border: none !important; overflow: hidden !important; height: 0px !important; display: inline !important; box-sizing: border-box !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div><div id="disqus_thread" class="disqus-thread"><iframe id="dsq-app9343" name="dsq-app9343" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/saved_resource(1).html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 611px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div>
                </div>
                <!-- disqus 评论框 end -->
                

                
            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5 id="catalog">
                        <a class="catalog-toggle" href="https://baddogzz.github.io/2020/02/07/Unload-Resources/#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"><li class="h2_nav active"><a href="https://baddogzz.github.io/2020/02/07/Unload-Resources/#%E5%85%B3%E4%BA%8Eassetbundle%E7%9A%84%E5%8D%B8%E8%BD%BD" rel="nofollow">关于AssetBundle的卸载</a></li><li class="h2_nav"><a href="https://baddogzz.github.io/2020/02/07/Unload-Resources/#%E5%85%B3%E4%BA%8Eassetbundleunload" rel="nofollow">关于AssetBundle.Unload</a></li><li class="h2_nav"><a href="https://baddogzz.github.io/2020/02/07/Unload-Resources/#%E5%8D%B8%E8%BD%BDassetbundle%E7%9A%84%E7%AD%96%E7%95%A5" rel="nofollow">卸载AssetBundle的策略</a></li><li class="h4_nav"><a href="https://baddogzz.github.io/2020/02/07/Unload-Resources/#%E6%9A%97%E9%BB%91%E8%A1%80%E7%BB%9F%E7%9A%84%E7%AD%96%E7%95%A5" rel="nofollow">暗黑血统的策略</a></li><li class="h4_nav"><a href="https://baddogzz.github.io/2020/02/07/Unload-Resources/#%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E7%9A%84%E7%AD%96%E7%95%A5" rel="nofollow">当前项目的策略</a></li><li class="h2_nav"><a href="https://baddogzz.github.io/2020/02/07/Unload-Resources/#%E6%80%BB%E7%BB%93" rel="nofollow">总结</a></li></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                


<section>
    
        <hr class="hidden-sm hidden-xs">
    
    <h5 id="featured-tags"><a href="https://baddogzz.github.io/archive/">FEATURED TAGS</a></h5>
    <div class="tags">
        
        
        
        
        
        
                <a data-sort="0001" href="https://baddogzz.github.io/archive/?tag=Unity" title="Unity" rel="41">Unity</a>
        
                <a data-sort="0012" href="https://baddogzz.github.io/archive/?tag=Shader" title="Shader" rel="30">Shader</a>
        
                <a data-sort="0026" href="https://baddogzz.github.io/archive/?tag=%E5%B0%8F%E7%94%9C%E7%94%9C" title="小甜甜" rel="16">小甜甜</a>
        
                <a data-sort="0040" href="https://baddogzz.github.io/archive/?tag=Lux" title="Lux" rel="2">Lux</a>
        
                <a data-sort="0040" href="https://baddogzz.github.io/archive/?tag=SRP" title="SRP" rel="2">SRP</a>
        
                <a data-sort="0040" href="https://baddogzz.github.io/archive/?tag=URP" title="URP" rel="2">URP
    </a></div><a data-sort="0040" href="https://baddogzz.github.io/archive/?tag=URP" title="URP" rel="2">
</a></section><a data-sort="0040" href="https://baddogzz.github.io/archive/?tag=URP" title="URP" rel="2">


                <!-- Friends Blog -->
                
<hr>
<h5 id="friends">FRIENDS</h5>
</a><ul class="list-inline"><a data-sort="0040" href="https://baddogzz.github.io/archive/?tag=URP" title="URP" rel="2">
  
  </a><li><a data-sort="0040" href="https://baddogzz.github.io/archive/?tag=URP" title="URP" rel="2"></a><a href="https://fatdogsp.github.io/">Bad Fat Dog</a></li>
  
  <li><a href="https://www.jianshu.com/u/8f5bfc31553e">简书|恶毒的狗</a></li>
  
  <li><a href="https://blog.csdn.net/weixin_45979158">csdn|恶毒的狗</a></li>
  
  <li><a href="https://juejin.im/user/5e15402cf265da5d1805f646">掘金|恶毒的狗</a></li>
  
  <li><a href="https://noodle1983.github.io/">noodle1983</a></li>
  
</ul>

            </div>
        </div>
    </div>
</article>

<!-- add support for mathjax by voleking-->






<!-- disqus 公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = "baddogzz";
    var disqus_identifier = "/2020/02/07/Unload-Resources";
    var disqus_url = "https://baddogzz.github.io//2020/02/07/Unload-Resources/";

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<!-- disqus 公共JS代码 end -->




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'right',
          // icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- SNS Link -->
                


<ul class="list-inline text-center">


  
  
  
  
  
  
  <li>
    <a target="_blank" href="https://github.com/baddogzz">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
</ul>

                <p class="copyright text-muted">
                    Copyright © 恶毒的狗 2021
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/hux-blog.min.js"></script>

<!-- Service Worker -->

<script src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/snackbar.js"></script>
<script src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/sw-registration.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->





<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->

<script>
    // dynamic User by Hux
    var _gaId = 'UA-154013464-1';
    var _gaDomain = '';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>



<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = 'f24a9f6b84ff3c625495e3dbd14fd06b';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog (selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector),a,n,t,l,i,c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#"+$(this).prop('id');
            t = $(this).text();
            c = $('<a href="'+i+'" rel="nofollow">'+t+'</a>');
            l = $('<li class="'+n+'_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function(e){
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->




<!-- Image to hack wechat -->
<img src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/icon_wechat.png" width="0" height="0">
<!-- Migrate from head to bottom, no longer block render and still work -->




<iframe style="display: none;" src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/saved_resource(2).html"></iframe><iframe style="display: none;" src="./关于AssetBundle的卸载 - 恶毒的狗 _ Bad Fat Dog_files/saved_resource(3).html"></iframe></body></html>